{% extends "suite-base.html" %}
{% block title_name %}cycles list{% endblock %}
<div class="page-header">

<div id="filter">
<form action="{{script}}/cycles">
<input type="hidden" name="user" value="{{user}}" />
<input type="hidden" name="suite" value="{{suite}}" />
<input type="hidden" name="per_page" value="{{per_page}}" />
<div class="input-append">
<select name="order" title="Sort order">
{% for k, v in [("time_desc", "new-&gt;old"),
                ("time_asc", "old-&gt;new")] -%}
<option
{% if order and order == k -%}
selected="selected"
{% endif -%}
value="{{k}}">{{v}}</option>
{% endfor -%}
</select>
<input type="submit" class="btn btn-primary" value="update" />
</div>
</form>

</div>
</div>

<div class="top_nav">
<div class="container-fluid">
<div class="row-fluid">
{% if of_n_entries == 0 -%}
<div class="span12">
<span class="label">Result loaded
<abbr class="livestamp" title="{{time}}">{{time}}</abbr></span>
<span class="text-info">No match</span>
</div>
{% elif per_page == 0 or per_page >= of_n_entries -%}
<div class="span12">
<span class="label">Result loaded
<abbr class="livestamp" title="{{time}}">{{time}}</abbr></span>
<span class="text-info">Page 1 of 1 Entries 1-{{of_n_entries}}</span>
</div>
{% else -%}
<div class="span12">
<form action="{{script}}/cycles" class="form-inline">
<input type="hidden" name="user" value="{{user}}" />
<input type="hidden" name="suite" value="{{suite}}" />
<input type="hidden" name="per_page" value="{{per_page}}" />
<ul class="inline">
<li class="previous">
<button id="page-prev" title="previous"
{% if page == 1 -%}
class="btn btn-link disabled"
disabled="disabled"
{% else %}
class="btn btn-link"
{% endif %}
>&laquo;</button>
</li>
<li class="page_entries">
<select id="page" name="page">
{% for i_page in range(n_pages) -%}
<option
{% if i_page + 1 == page -%}
selected="selected"
{% endif -%}
value="{{i_page + 1}}">Page {{i_page + 1}} of {{n_pages}}
~
{% if (i_page + 1) * per_page < of_n_entries -%}
Entries {{i_page * per_page + 1}}-{{(i_page + 1) * per_page}}
{% else -%}
Entries {{i_page * per_page + 1}}-{{of_n_entries}}
{% endif -%}
of {{of_n_entries}}
</option>
{% endfor -%}
</select>
</li>
<li class="next">
<button id="page-next" title="next"
{% if page == n_pages -%}
class="btn btn-link disabled"
disabled="disabled"
{% else -%}
class="btn btn-link"
{% endif -%}
>&raquo;</button>
</li>
<li><span class="label">Result loaded
<abbr class="livestamp" title="{{time}}">{{time}}</abbr></span></li>
</ul>
</form>
</div><!-- pager -->
{% endif -%}
</div>
</div>
</div>

{% for entry in entries -%}
<div class="row-fluid entry">
<div class="span2">
<a href="{{script}}/jobs/{{user}}/{{suite}}?cycles={{entry.cycle|replace('+', '%2B')}}" class="cycle" title="{{entry.cycle}}">{{entry.cycle}}</a>
</div>
{% for state, icon, label, title in [("active", "play", "info", "active tasks"), ("success", "ok", "success", "succeeded tasks"), ("fail", "warning-sign", "important", "failed tasks")] -%}
{% set n_state = entry.n_states[state] -%}
<div class="span2">
{% if n_state -%}
{% set state_url = script ~ "/jobs/" ~ user ~ "/" ~ suite ~ "?cycles=" ~ entry.cycle|replace('+', '%2B') -%}
<a href="{{state_url}}{% for no_state in ["active", "success", "fail"] if no_state != state %}&amp;no_status={{no_state}}{% endfor %}">
{% endif -%}
<span class="label{% if n_state %} label-{{label}}{% endif %}">
<i class="icon-{{icon}} icon-white" title="{{state}}"></i>
</span>
<span class="badge{% if n_state %}  badge-{{label}}{% endif %}" title="{{title}}">{{entry.n_states[state]}}</span>
{% if n_state %}</a>{% endif %}
{% if state=="fail" and entry.n_states["job_fails"] > 0 %}(<span class="badge  badge-{{label}}" title="job failures">{{entry.n_states["job_fails"]}}</span>){% endif %}
</div>
{% endfor -%}

<div class="span4">
<span class="label">
<i class="icon-time icon-white" title="last active"></i>
last active
</span>
<abbr class="livestamp" title="{{entry.max_time_updated}}">{{entry.max_time_updated}}</abbr>
</div>

</div>
{% endfor -%}
</div>
{% endblock %}
